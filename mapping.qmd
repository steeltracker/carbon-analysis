---
title: "mapping"
format: html
editor: visual
---

```{r}
library(terra)
library(sf)
library(raster)
library(here)
library(janitor)
library(tidyverse)
library(tmap)
library(rmapshaper)
```

```{r}
shapes <- read_sf("~/Desktop/meds-courses/capstone-files/data/egrid2020_subregions/eGRID2020_subregions.shp") %>% 
  clean_names() %>% 
  filter(!zip_subregi %in% c("AKGD", "AKMS", "HIMS", "HIOA", "PRMS"))

simple_shapes <- ms_simplify(shapes, keep = 0.0005)

plant_points <- st_geometry(st_as_sf(regional_plant_emissions, coords = c("lon", "lat"))) %>% 
  st_set_crs("WGS84")

tm_shape(simple_shapes) +
  tm_polygons() +
  tm_shape(plant_points) +
  tm_dots()

overlap <- st_within(plant_points, simple_shapes)

vector <- c()
regional_plant_emissions1 <- regional_plant_emissions
for (i in seq_along(overlap)) {
  vector[i] <- simple_shapes$zip_subregi[overlap[[i]]]
}

regional_plant_emissions1 <- regional_plant_emissions1 %>% 
  mutate(subregions = vector)
```
